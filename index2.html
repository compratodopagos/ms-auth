<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./index2.js"></script>
</head>

<body>

    <style>
        .content {
            display: inline-block;
        }

        .inactive {
            opacity: .5;
            pointer-events: none;
        }

        .row {
            display: flex;
        }

        .col {
            cursor: pointer;
            width: 50px;
            height: 50px;
            border: 1px solid lightgray;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            font-family: sans-serif;
            color: #5c5c5c;
        }
    </style>

    <div id="msg"></div>

    <div class="content inactive">
        <div class="row">
            <div class="col" id="A1"></div>
            <div class="col" id="B1"></div>
            <div class="col" id="C1"></div>
        </div>
        <div class="row">
            <div class="col" id="A2"></div>
            <div class="col" id="B2"></div>
            <div class="col" id="C2"></div>
        </div>
        <div class="row">
            <div class="col" id="A3"></div>
            <div class="col" id="B3"></div>
            <div class="col" id="C3"></div>
        </div>
    </div>

    <div>
        <button onclick="startGame()">Start game</button>
    </div>

    <script>

        class Game {
            players = ['O', 'X'];
            turn = 0;
            checked = [];

            optionsWin = [
                ['A1','A2','A3'],
                ['B1','B2','B3'],
                ['C1','C2','C3'],

                ['A1','B1','C1'],
                ['A2','B2','C2'],
                ['A3','B3','C3'],

                ['A1','B2','C3'],
                ['A3','B2','C1']
            ]

            constructor() {
                console.log('aqui estoy')
                this.checked = [];
                const content = document.getElementsByClassName('content')[0];
                content.innerHTML = `
                <div class="row">
                    <div class="col" id="A1"></div>
                    <div class="col" id="B1"></div>
                    <div class="col" id="C1"></div>
                </div>
                <div class="row">
                    <div class="col" id="A2"></div>
                    <div class="col" id="B2"></div>
                    <div class="col" id="C2"></div>
                </div>
                <div class="row">
                    <div class="col" id="A3"></div>
                    <div class="col" id="B3"></div>
                    <div class="col" id="C3"></div>
                </div>
                `
                content.classList.remove('inactive');
                document.addEventListener('click', (e) => {
                    const { target } = e;
                    if (target.classList.value.includes('col')) {
                        this.check(target);
                    }
                })
            }

            check(object) {
                const position = object.getAttribute('id');
                this.checked.push({ player: this.players[this.turn], position });
                object.append(`${this.players[this.turn]}`)
                this.turn = this.turn == 1 ? 0 : 1;
                this.validWin();
            }

            validWin(){
                this.players.forEach(player => {
                    const jugadas = this.checked.filter(c => c.player == player).map(c => c.position);
                    let winner = true;
                    for(let win of this.optionsWin){
                        for(let w of win){
                            winner = jugadas.some(j => j == w)? true : false;
                            if(!winner) break;
                        }
                        if(winner) break;
                    }
                    if(winner){
                        document.getElementById('msg').append(`El jugador ${player} es el feliz ganador!`);
                        document.getElementsByClassName('content')[0].classList.add('inactive');
                        window.game = undefined;
                    }
                })
            }

        }

        function startGame() {
            window.game = new Game();
        }
    </script>

</body>

</html>