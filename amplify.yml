version: 1
# backend:
#   phases:
#     build:
#       commands:
#         - nvm install 22 > /dev/null 2>&1
#         - nvm use 22
#         - npm ci --cache .npm --prefer-offline
#         # Despliegue de backend Amplify
#         - npx ampx pipeline-deploy --branch "$AWS_BRANCH" --app-id "$AWS_APP_ID"

frontend:
  phases:
    preBuild:
      commands:
        # Instala Node (opcional si quieres una versión específica)
        - nvm install 22 > /dev/null 2>&1
        - nvm use 22
        # Instala TODAS las dependencias, incluidas devDependencies
        - npm ci --cache .npm --prefer-offline
    build:
      commands:
        - npm run build

  artifacts:
    baseDirectory: dist
    files:
      - '**/*'

  cache:
    paths:
      - .npm/**/*
      - node_modules/**/*